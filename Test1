import pandas as pd

# Read the pandas file
df = pd.read_csv('your_file.csv')

# Convert the column to strings
df['table_names'] = df['table_names'].astype(str)

# Define a function to extract database and table names
def extract_names(name):
    try:
        parts = name.split('.')
        database = parts[0]
        tables = parts[1].split(',')
        return database, tables
    except IndexError:
        return None, None

# Apply the function to extract database and table names
split_names = df['table_names'].apply(lambda x: extract_names(x))
df['Database'] = [names[0] if names[0] is not None else "" for names in split_names]

# Filter out None values for table names
all_tables = [item for sublist in [names[1] for names in split_names if names[1] is not None] for item in sublist]

# Create a set of unique table names
unique_tables = set(all_tables)

# Create new columns for each unique combination of database name and table name
for database, tables in split_names:
    if tables is not None:
        for table in tables:
            column_name = f'{database}_{table}'
            df[column_name] = df['table_names'].apply(lambda x: 1 if f"{database}.{table}" in x else 0)

# Now you have 'Database' column and individual columns for each unique combination of database and table name with 1 or 0 indicating presence
