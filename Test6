import pandas as pd

# Read the pandas file
df = pd.read_csv('your_file.csv')

# Convert the column to strings
df['table_names'] = df['table_names'].astype(str)

# Define a function to extract unique database and table names
def extract_unique_names(name):
    parts = name.split('.')
    return parts[0], parts[1].split(',') if len(parts) > 1 else []

# Apply the function to extract unique database and table names
unique_names = df['table_names'].apply(lambda x: extract_unique_names(x))

# Collect all unique database and table names
unique_databases = set()
unique_tables = set()

for database, tables in unique_names:
    unique_databases.add(database)
    unique_tables.update(tables)

# Combine unique database and table names into single strings
database_str = ', '.join(unique_databases)
table_str = ', '.join(unique_tables)

# Add the summary columns to the original DataFrame
df['Unique_Database_Names'] = database_str
df['Unique_Table_Names'] = table_str

# Now you have two additional columns in the original DataFrame: 'Unique_Database_Names' containing unique database names separated by commas if more than one, and 'Unique_Table_Names' containing unique table names separated by commas if more than one
